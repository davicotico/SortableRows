var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},SortableRows=function(){function t(t){if(this.currRow=null,this.dragElem=null,this.startX=0,this.startY=0,this.moveX=0,this.moveY=0,this.isDragged=!1,this.table=document.getElementById(t),null==this.table)throw'You called the SortableRows constructor with "'+t+'" ID, but there is no such element in the document.';if(this.tbody=this.table.querySelector("tbody"),"table"!=this.table.tagName.toLowerCase())throw"The selected element is not a <table>.";this.table.classList.add("draggable-table"),this.init()}return t.prototype.init=function(){this.bindEvents()},t.prototype.onStartDragging=function(t){if(!(t instanceof MouseEvent)||0==t.button){var e=this.getTargetRow(t.target);if(e){this.currRow=e,this.addDraggableRow(e),this.currRow.classList.add("is-dragging");var i=this.getCoords(t);this.startX=i.x,this.startY=i.y,this.isDragged=!0}}},t.prototype.onMove=function(t){if(this.isDragged){var e=this.getCoords(t);this.moveX=e.x-this.startX,this.moveY=e.y-this.startY,this.moveRow(this.moveX,this.moveY)}},t.prototype.onEndDragging=function(t){var e;this.isDragged&&(null===(e=this.currRow)||void 0===e||e.classList.remove("is-dragging"),this.table.removeChild(this.dragElem),this.dragElem=null,this.isDragged=!1)},t.prototype.bindEvents=function(){var t=this;this.table.addEventListener("touchstart",function(e){return t.onStartDragging(e)}),this.table.addEventListener("touchmove",function(e){return t.onMove(e)}),this.table.addEventListener("touchend",function(e){return t.onEndDragging(e)}),this.table.addEventListener("mousedown",function(e){return t.onStartDragging(e)}),this.table.addEventListener("mousemove",function(e){return t.onMove(e)}),this.table.addEventListener("mouseup",function(e){return t.onEndDragging(e)})},t.prototype.swapRow=function(t,e){var i=Array.from(this.tbody.children).indexOf(this.currRow),r=i>e?this.currRow:t,n=i>e?t:this.currRow;this.tbody.insertBefore(r,n)},t.prototype.moveRow=function(t,e){var i=this.dragElem;i.style.transform="translate3d("+t+"px, "+e+"px, 0)";for(var r=i.getBoundingClientRect(),n=r.y,o=n+r.height,s=this.getRows(),a=0;a<s.length;a++){var h=s[a],l=h.getBoundingClientRect(),g=l.y,d=g+l.height;this.currRow!==h&&this.isIntersecting(n,o,g,d)&&Math.abs(n-g)<l.height/2&&this.swapRow(h,a)}},t.prototype.addDraggableRow=function(t){this.dragElem=t.cloneNode(!0),this.dragElem.classList.add("draggable-table-tr"),this.dragElem.style.height=this.getStyle(t,"height"),this.dragElem.style.background=this.getStyle(t,"background-color");for(var e=0;e<t.children.length;e++){var i=t.children[e],r=this.dragElem.children[e];r.style.width=this.getStyle(i,"width"),r.style.height=this.getStyle(i,"height"),r.style.padding=this.getStyle(i,"padding"),r.style.margin=this.getStyle(i,"margin")}this.table.appendChild(this.dragElem);var n=t.getBoundingClientRect(),o=this.dragElem.getBoundingClientRect();this.dragElem.style.bottom=o.y-n.y-n.height+"px",this.dragElem.style.left="-1px",this.table.dispatchEvent(new MouseEvent("mousemove",{view:window,cancelable:!0,bubbles:!0}))},t.prototype.getRows=function(){return this.table.querySelectorAll("tbody tr")},t.prototype.getTargetRow=function(t){var e=t.tagName.toLowerCase();return"tr"==e?t:"td"==e?t.closest("tr"):void 0},t.prototype.getCoords=function(t){var e=0,i=0;return t instanceof MouseEvent?(e=t.clientX,i=t.clientY):(e=t.touches[0].clientX,i=t.touches[0].clientY),{x:e,y:i}},t.prototype.getStyle=function(t,e){return getComputedStyle(t).getPropertyValue(e)},t.prototype.isIntersecting=function(t,e,i,r){return Math.max(t,e)>=Math.min(i,r)&&Math.min(t,e)<=Math.max(i,r)},t.prototype.getData=function(){for(var t,e=[],i=this.table,r=0;r<i.tBodies.length;r++)for(var n=i.tBodies[r],o=0;o<n.rows.length;o++){var s=null===(t=n.rows.item(o))||void 0===t?void 0:t.dataset;e.push(__assign({position:o},s))}return e},t}();export{SortableRows};
/**
 * Draggable and sortable table rows. The output is an array of objects with a position attribute on each object.
 * @author David Tomas Ticona Saravia
 * @version 1.1.2
 * @license MIT
 */