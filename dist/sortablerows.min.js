/**
 * Draggable and sortable table rows. The output is an array of objects with a position attribute on each object.
 * @author David Tomas Ticona Saravia
 * @version 1.1.1
 * @license MIT
 */
"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},SortableRows=function(){function t(t){if(this.currRow=null,this.dragElem=null,this.startX=0,this.startY=0,this.moveX=0,this.moveY=0,this.isDragged=!1,this.table=document.getElementById(t),this.tbody=this.table.querySelector("tbody"),null==this.table)throw'You called the SortableRows constructor with "'+t+'" ID, but there is no such element in the document.';if("table"!=this.table.tagName.toLowerCase())throw"The selected element is not a <table>.";this.table.classList.add("draggable-table"),this.init()}return t.prototype.init=function(){this.bindEvents()},t.prototype.onStartDragging=function(t){var e;t instanceof MouseEvent&&0!=t.button||(e=this.getTargetRow(t.target))&&(this.currRow=e,this.addDraggableRow(e),this.currRow.classList.add("is-dragging"),t=this.getCoords(t),this.startX=t.x,this.startY=t.y,this.isDragged=!0)},t.prototype.onMove=function(t){this.isDragged&&(t=this.getCoords(t),this.moveX=t.x-this.startX,this.moveY=t.y-this.startY,this.moveRow(this.moveX,this.moveY))},t.prototype.onEndDragging=function(t){var e;this.isDragged&&(null!==(e=this.currRow)&&void 0!==e&&e.classList.remove("is-dragging"),this.table.removeChild(this.dragElem),this.dragElem=null,this.isDragged=!1)},t.prototype.bindEvents=function(){var e=this;this.table.addEventListener("touchstart",function(t){return e.onStartDragging(t)}),this.table.addEventListener("touchmove",function(t){return e.onMove(t)}),this.table.addEventListener("touchend",function(t){return e.onEndDragging(t)}),this.table.addEventListener("mousedown",function(t){return e.onStartDragging(t)}),this.table.addEventListener("mousemove",function(t){return e.onMove(t)}),this.table.addEventListener("mouseup",function(t){return e.onEndDragging(t)})},t.prototype.swapRow=function(t,e){var i=Array.from(this.tbody.children).indexOf(this.currRow),r=e<i?this.currRow:t,t=e<i?t:this.currRow;this.tbody.insertBefore(r,t)},t.prototype.moveRow=function(t,e){var i=this.dragElem;i.style.transform="translate3d("+t+"px, "+e+"px, 0)";for(var i=i.getBoundingClientRect(),r=i.y,n=r+i.height,o=this.getRows(),s=0;s<o.length;s++){var a=o[s],h=a.getBoundingClientRect(),l=h.y,g=l+h.height;this.currRow!==a&&this.isIntersecting(r,n,l,g)&&Math.abs(r-l)<h.height/2&&this.swapRow(a,s)}},t.prototype.addDraggableRow=function(t){this.dragElem=t.cloneNode(!0),this.dragElem.classList.add("draggable-table-tr"),this.dragElem.style.height=this.getStyle(t,"height"),this.dragElem.style.background=this.getStyle(t,"background-color");for(var e=0;e<t.children.length;e++){var i=t.children[e],r=this.dragElem.children[e];r.style.width=this.getStyle(i,"width"),r.style.height=this.getStyle(i,"height"),r.style.padding=this.getStyle(i,"padding"),r.style.margin=this.getStyle(i,"margin")}this.table.appendChild(this.dragElem);var n=t.getBoundingClientRect(),o=this.dragElem.getBoundingClientRect();this.dragElem.style.bottom=o.y-n.y-n.height+"px",this.dragElem.style.left="-1px",this.table.dispatchEvent(new MouseEvent("mousemove",{view:window,cancelable:!0,bubbles:!0}))},t.prototype.getRows=function(){return this.table.querySelectorAll("tbody tr")},t.prototype.getTargetRow=function(t){var e=t.tagName.toLowerCase();return"tr"==e?t:"td"==e?t.closest("tr"):void 0},t.prototype.getCoords=function(t){var e=0,i=0,i=t instanceof MouseEvent?(e=t.clientX,t.clientY):(e=t.touches[0].clientX,t.touches[0].clientY);return{x:e,y:i}},t.prototype.getStyle=function(t,e){return getComputedStyle(t).getPropertyValue(e)},t.prototype.isIntersecting=function(t,e,i,r){return Math.max(t,e)>=Math.min(i,r)&&Math.min(t,e)<=Math.max(i,r)},t.prototype.getData=function(){for(var t=[],e=this.table,i=0;i<e.tBodies.length;i++)for(var r=e.tBodies[i],n=0;n<r.rows.length;n++){var o=null===(o=r.rows.item(n))||void 0===o?void 0:o.dataset;t.push(__assign({position:n},o))}return t},t}();
//# sourceMappingURL=sortablerows.min.js.map